<!DOCTYPE html>
<html lang="en">
<head>




<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
<meta name="generator" content="Orchid 0.17.5"/>
<link rel="icon" href="http://localhost:8080/favicon.ico">


<meta name="robots" content="index, follow">



<title>Writing Alchemist simulations</title>


<meta name="description" content="Practical aggregate programming.">



<link rel="prev" href="http://localhost:8080/wiki/usage/quickstart">


<link rel="next" href="http://localhost:8080/wiki/usage/gui">


<script>
    window.site = {"orchidVersion":"0.17.5","baseUrl":"http://localhost:8080","environment":"debug","version":"13.0.3-dev18+2bb83c70"};
</script>





<!-- start:debug info -->

<!-- THEME -->
<!-- Type: BsDoc -->
<!-- Class: com.eden.orchid.bsdoc.BSDocTheme -->

<!-- PAGE -->
<!-- Type: wiki -->
<!-- Class: com.eden.orchid.wiki.pages.WikiPage -->
<!-- Layout: index -->
<!-- Resolved Layout: templates/layouts/index.peb -->
<!-- Page Template: wiki, page -->
<!-- Resolved Page Template:  -->

<!-- RESOURCE -->
<!-- Class: com.eden.orchid.api.resources.resource.FileResource -->
<!-- Source Filename: wiki/usage/yaml.md -->

<!-- COMPLETE PAGE CONFIGURATION -->
<script>
    window.allData = {"reference":{"path":"wiki/usage","baseUrl":"http://localhost:8080","fileName":"yaml","extension":"html","usePrettyUrl":true,"link":"http://localhost:8080/wiki/usage/yaml"},"next":{"path":"wiki/usage","baseUrl":"http://localhost:8080","fileName":"gui","extension":"html","usePrettyUrl":true,"link":"http://localhost:8080/wiki/usage/gui"},"previous":{"path":"wiki/usage","baseUrl":"http://localhost:8080","fileName":"quickstart","extension":"html","usePrettyUrl":true,"link":"http://localhost:8080/wiki/usage/quickstart"},"description":"","title":"Writing Alchemist simulations"};
</script>

<!-- end:debug info -->



<!-- start:inject styles -->
<link rel="stylesheet" type="text/css" href="https://netdna.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"/>
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css"/>
<link rel="stylesheet" type="text/css" href="http://localhost:8080/BsDoc/447b9123/assets/css/bsdoc.css"/>
<link rel="stylesheet" type="text/css" href="http://localhost:8080/assets/css/pygments.css"/>
<link rel="stylesheet" type="text/css" href="https://rawgit.com/PrismJS/prism-themes/master/themes/prism-ghcolors.css"/>
<!-- end:inject styles -->


</head>
<body>




<a class="github-fork-ribbon left-top"
   href="https://github.com/Protelis/Protelis"
   title="Fork me on GitHub">Fork me on GitHub</a>


<header class="navbar navbar-fixed-top bs-docs-nav">
    <div class="container">
        <div class="navbar-header" role="banner">
            <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://localhost:8080">Protelis: the language for aggregate computing</a>
        </div>
        <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
            <ul class="nav navbar-nav navbar-right">
                
                    
                        <li><a href="http://localhost:8080">Home</a></li>
                    
                
                    
                        <li><a href="">Documentation</a></li>
                    
                
                    
                        <li><a href="http://localhost:8080/wiki/quickstart">Quick start</a></li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Tutorials<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="http://localhost:8080/wiki/tutorials/alchemist">Simulations with Alchemist</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Language<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="http://localhost:8080/wiki/language/syntax">Changelog</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Using Protelis<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="http://localhost:8080/wiki/usage/installation">Requirements and installation</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/quickstart">Quick start</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/yaml">Writing Alchemist simulations</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/gui">Alchemist graphical interface</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/biochemistry">Alchemist biochemistry incarnation</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/protelis">Alchemist Protelis incarnation</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/sapere">SAPERE</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/scafi">Scafi</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/indoor">Simulation of indoor environments</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/cognitive-agents">Using Cognitive Agents</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/smartcam">With Smart Cameras</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/maps">Maps and GPS traces</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/export">Exporting data</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/batch">Executing batches</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/grid">Grid computing support</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/customization">Writing custom components</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/issues">Troubleshooting and known issues</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Simulation examples<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="http://localhost:8080/wiki/examples/protelis">With Protelis</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/examples/scafi">With Scafi</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/examples/maps">On maps</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li><a href="http://localhost:8080/wiki/license">License</a></li>
                    
                
            </ul>
        </nav>
    </div>
</header>


<div id="top"></div>


    <div class="bs-docs-masthead" id="jumbotron">
        <div class="container">
            <h1 class="home-title">Writing Alchemist simulations</h1>
        </div>
    </div>


<div class="container bs-docs-container">
    <div class="row">
        <div class="col-md-9" role="main">
        <nav aria-label="breadcrumb">
    <ul class="breadcrumb">
    
    
        <li class="breadcrumb-item"><a href="http://localhost:8080/wiki">Wiki</a></li>
    
    
    
        <li class="breadcrumb-item active" aria-current="page">Writing Alchemist simulations</li>
    
    
    </ul>
</nav>
        

        
        
            
    <!-- start:inject components -->
    
        
            
                
                    
                        <p>As a first step, we recommend learning the YAML basics.
The language is so simple and human readable that there is probably no better way to learn it than to read it directly.
My suggestion is to use the tutorial &quot;<a href="https://learnxinyminutes.com/docs/yaml/">Learn X in Y minutes where X = YAML</a>&quot;,
it should provide a good YAML guide (surely sufficient to follow the tutorial).</p>
<p>Alchemist expects a YAML map as input. In the following section, we'll discuss which keys it expects.
Of course, users are free to use all the YAML features (e.g. anchors) to organize their code and reduce duplication.</p>
<h2 id="choosing-an-incarnation">Choosing an incarnation</h2>
<p>The <code>incarnation</code> key is mandatory.
Actually, it's the only mandatory key.
The YAML parser expects a string value.
Such string will be used to get the most similarly named incarnation, namely the subclass of Incarnation whose simple
name is closest to the string.</p>
<p><strong>Examples</strong></p>
<pre><code class="language-yaml">incarnation: sapere
</code></pre>
<pre><code class="language-yaml">incarnation: protelis
</code></pre>
<pre><code class="language-yaml">incarnation: biochemistry
</code></pre>
<p><em>Note:</em> this is also the most minimal valid alchemist specification</p>
<h2 id="loading-arbitrary-java-classes-with-the-typeparameters-syntax">Loading arbitrary Java classes with the <code>type</code>/<code>parameters</code> syntax</h2>
<p>One important aspect of the Alchemist YAML is the ability to let the user control which actual Java classes should be
loaded inside a simulation, and which constructor should be used to do so.
Almost every entity of an Alchemist simulation can be instanced using arbitrary Java classes that implement the required
interfaces.
When the alchemist YAML parser encounters a YAML Map providing the keys <code>type</code> and <code>parameters</code>, it tries to resolve the
value of the value associated to <code>type</code> to a class name, then tries to create the object by calling the constructor with
parameters most suited to the value of <code>parameters</code>.</p>
<p><strong>Class name resolution</strong></p>
<p>The value associated with <code>type</code> must be a string representing a valid Java identifier.
If the value contains one or more <code>.</code> characters, then it will be interpreted as a fully qualified name.
If no such character is included, then <em>the default package for the desired alchemist entity will be prefixed</em>.
Alchemist won't ever attempt to load a class situated in the default package (so don't put your classes there, it's a
bad practice anyway).</p>
<p><strong>Object instancing</strong></p>
<p>If the class gets loaded correctly (meaning if a class is present in the classpath with the fully qualified name,
whether it was passed or guessed by Alchemist), then its constructors get sorted based on the number and type of
parameters.
The system tries to build an object with all the available constructors until one of them provides an instanced object,
in an order that considers both the current context (namely, the entities that have already been instanced) and the
value of <code>parameters</code>.</p>
<p>For instance, imagine that you are trying to build an instance of a Reaction, whose only constructor requires an
Environment, a Node, an <code>int</code> and a <code>String</code>.
In this case, an Environment and a Node must have already been created (or the YAML loader won't be at this point).
As a consequence, the first two parameters are automatically inferred by the current context and passed to the constructor.
The other two parameters can not be inferred this way; instead, the value associated to <code>parameters</code> is used to extract the proper values (if possible).
In this case, this would have been a valid <code>parameters</code> entry:</p>
<pre><code class="language-yaml">type: my.package.MyCustomReaction
parameters: [4, foo]
</code></pre>
<p>As you can easily infer, the value of <code>parameters</code> must be a YAML list.</p>
<p>Don't despair if the class loading system is still unclear: it is used pervasively and it will become clearer with the examples in the next sections.</p>
<h2 id="setting-up-the-environment">Setting up the environment</h2>
<p>The <code>environment</code> key is used to load the Environment implementation.
It is optional and it defaults to a continuous bidimensional space.
If no fully qualified environment name is provided for class loading, Alchemist uses the package
it.unibo.alchemist.model.implementations.environments to search for the class.</p>
<h3 id="examples">Examples</h3>
<p>The following simulations are equivalent, and load the default environment (which is incarnation independent, here
<code>protelis</code> is picked, but it works for any other incarnation as well):</p>
<pre><code class="language-yaml">incarnation: protelis
</code></pre>
<pre><code class="language-yaml">incarnation: protelis
environment:
  type: Continuous2DEnvironment
</code></pre>
<pre><code class="language-yaml">incarnation: protelis
environment:
  type: it.unibo.alchemist.model.implementations.environments.Continuous2DEnvironment
</code></pre>
<pre><code class="language-yaml">incarnation: protelis
environment:
  type: Continuous2DEnvironment
  parameters: []
</code></pre>
<p>OSMEnvironment allows for running simulations over real world maps. The following simulation
loads data from an Openstreetmap file (OSM, XML and PBF formats are supported) located in the classpath in the folder
<code>maps</code>:</p>
<pre><code class="language-yaml">incarnation: protelis
environment:
  type: OSMEnvironment
  parameters: [maps/foo.pbf]
</code></pre>
<p>ImageEnvironment loads data from a black and white raster image file (in this example, located in the
classpath in the folder <code>images</code>), interpreting the black pixels as obstacles (areas that cannot be accessed by nodes):</p>
<pre><code class="language-yaml">incarnation: protelis
environment:
  type: ImageEnvironment
  parameters: [images/foo.png]
</code></pre>
<p>Finally, if you write your own custom class named <code>my.package.FooEnv</code> implementing Environment, whose
constructor requires a String and a double, you can use it in the simulator by writing, for instance:</p>
<pre><code class="language-yaml">incarnation: protelis
environment:
  type: my.package.FooEnv
  parameters: [bar, 2.2]
</code></pre>
<p>The environments shipped with the distribution can be found in the package
it.unibo.alchemist.model.implementations.environments.</p>
<h2 id="declaring-variables">Declaring variables</h2>
<p>The <code>variables</code> section lists variable simulation values.
A variable defines some kind of value that can be referenced in the simulation file.</p>
<p>There are two kinds of variables: free and dependent variables.
The difference is that variables of the latter kind can always be computed given the values of all the other variables.</p>
<h3 id="free-variables">Free variables</h3>
<p>Free variables define a set of values and a default.
The value set is used to define the batch matrix, i.e., if the variable is selected for a batch, all its value are
included in the cartesian product that determines which simulations are to be executed.
If the simulation is not executed as batch, then the default value is used</p>
<h4 id="linear-variables">Linear variables</h4>
<h4 id="geometric-variables">Geometric variables</h4>
<h4 id="arbitrary-valued-variables">Arbitrary-valued variables</h4>
<h3 id="dependent-variables">Dependent variables</h3>
<p>Some variables are combination of free parameters.
Let's suppose that we want to deploy on a circle, but for some reason (e.g. because it is required by the constructor of some action) we need to compute and have available radius and perimeter.
We don't need to control both of them: the perimeter can be computed.
Alchemist provides support for performing computation over variables.
Let's first define our radius.
We want it to be a free variable, ranging geometrically from 0.1 to 10 in nine steps, and defaulting to 1.</p>
<pre><code class="language-yaml">variables:
  radius: &amp;radius
    type: GeometricVariable
    parameters: [1, 0.1, 10, 9]
</code></pre>
<p>Now we want to compute the diameter.
We can do so by using the <code>formula</code> syntax:</p>
<pre><code class="language-yaml">variables:
  radius: &amp;radius
    type: GeometricVariable
    parameters: [1, 0.1, 10, 9]
  diameter: &amp;diam
    formula: Math.PI * 2 * radius
</code></pre>
<p>How does it work?
Alchemist feeds the formula String to an interpreter and takes the result of the interpretation.
By default, <a href="https://groovy-lang.org/">Groovy</a> is used as language to interpret the formula, but other languages can be used.</p>
<p>Variables can be defined in any order.
Alchemist figures out the dependencies automatically, as far as there are no cyclic dependencies (e.g. variable <code>a</code> requires <code>b</code>, and <code>b</code> requires <code>a</code>).
Please note that the simulator variable dependency resolution system is not designed to solve mathematical systems,
so even though the problem has a well formed mathematical solution the actual variable resolution may fail;
e.g. if <code>a</code> is defined as <code>2 * b + 1</code>, and <code>b</code> is defined as <code>4 - a</code>, the system <strong>won't</strong> bind <code>a</code> to <code>3</code> and <code>b</code> to <code>1</code>,
but will simply fail complaining about circular dependencies.</p>
<h3 id="using-different-languages">Using different languages</h3>
<p>In order to use a language different than Groovy, the user may specify it explicitly by using the <code>language</code> keyword.
For example, Scala can be used:</p>
<pre><code class="language-yaml">variables:
  radius: &amp;radius
    type: GeometricVariable
    parameters: [1, 0.1, 10, 9]
  diameter: &amp;diam
    formula: Math.PI * 2 * radius
    language: scala
</code></pre>
<p>Or Kotlin:</p>
<pre><code class="language-yaml">variables:
  radius: &amp;radius
    type: GeometricVariable
    parameters: [1, 0.1, 10, 9]
  diameter: &amp;diam
    formula: listOf(Math.PI, 2.0, 0.3).fold(1.0) { a, b -&gt; a * b  }
    language: kotlin
</code></pre>
<p>The system is <a href="http://archive.fo/PGdk8">JSR-233</a>-compatible, as such, every language with a valid JSR-233 implementation could be used.
The only requirement for the language to be available is the availability in the runtime classpath of a JSR-233 compatible version of the desired language.
If Alchemist is being used (as recommended) in conjunction with Gradle, and you want to embed your favorite JSR-233 compatible scripting language, you should have a dependency declaration similar to:</p>
<pre><code class="language-kotlin">dependencies {
    ...
    runtimeOnly(&quot;my.favorite.scripting.language:supporting-jsr233:0.1.0&quot;)
    ...
}
</code></pre>
<p>For instance, Alchemist supports Kotlin and Groovy natively by simply providing in its <code>build.gradle.kts</code> something similar to:</p>
<pre><code class="language-kotlin">dependencies {
    ...
    runtimeOnly(&quot;org.codehaus.groovy:groovy-jsr223:2.5.7&quot;)
    runtimeOnly(&quot;org.jetbrains.kotlin:kotlin-scripting-jsr223-embeddable:1.3.40&quot;)
    runtimeOnly(&quot;org.jetbrains.kotlin:kotlin-script-runtime:1.3.40&quot;)
    runtimeOnly(&quot;org.jetbrains.kotlin:kotlin-script-util:1.3.40&quot;)}
    ...
</code></pre>
<p>Alchemist provides a number of ready-to use interpreters. Besides Groovy (used by default) it includes:</p>
<ul>
<li><a href="https://www.scala-lang.org/">Scala</a></li>
<li><a href="https://kotlinlang.org/">Kotlin</a></li>
</ul>
<p>Moreover, several implementations of the Java Virtual Machine feature internal interpreters for
<a href="https://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMAScript</a>/
<a href="https://en.wikipedia.org/wiki/JavaScript">Javascript</a>.
In case they are provided, such engines can be used without any additional effort.
Javascript used to be the default for Alchemist, but it has been replaced by Groovy since
<a href="https://openjdk.java.net/jeps/335">Nashorn, the interpreter embedded in OpenJDK, is deprecated</a>.</p>
<h4 id="multiline-programs">Multiline programs</h4>
<p>Sometimes data manipulation can get tricky and trivial scripting may no longer be enough.
In such cases, and especially with modern languages that allow for a reduced usage of cerimonial semicolons (such as Kotlin and Scala), it can be useful to write multiline programs.
This can be achieved in YAML by using the pipe <code>|</code> operator, as exemplified in the following snippet:</p>
<pre><code class="language-yaml">variables:
  a:
    formula: 22 + 1
    language: kt
  test:
    formula: |
      import com.google.common.reflect.TypeToken
      import com.google.gson.Gson
      Gson().fromJson&lt;Map&lt;String, List&lt;List&lt;List&lt;Double&gt;&gt;&gt;&gt;&gt;(
          ClassLoader.getSystemResourceAsStream(&quot;explorable-area.json&quot;)?.reader(),
          object: TypeToken&lt;Map&lt;String, List&lt;List&lt;List&lt;Double&gt;&gt;&gt;&gt;&gt;() {}.type
      )
      .get(&quot;coordinates&quot;)!!
      .first()
      .map { Pair(it.last(), it.first()) }
    language: kotlin
</code></pre>
<p>If the string begins with a <code>|</code>, its contents preserve newlines, thus allowing for multiline scripts of arbitrary complexity.</p>
<h4 id="known-issues">Known issues</h4>
<p>Alchemist exploit JSR-233's variable binding system to let the scripts use variables defined elsewhere.
Not all languages support this system properly.
In particular, Kotlin does not (yet) support variable injection and requires a workaround.
In order for a script to access a variable named <code>myVar</code>, the programmer should write instead <code>bindings[&quot;myVar&quot;]</code>.
The issue is being tracked as <a href="https://youtrack.jetbrains.com/issue/KT-15125">KT-15125</a>.
Once it gets solved (if ever), and as soon as Alchemist incorporates the version of Kotlin including the fix,
the workaround will no longer be necessary.</p>
<h3 id="using-variables">Using variables</h3>
<h2 id="controlling-the-reproducibility">Controlling the reproducibility</h2>
<p>Alchemist simulations can be reproduced by feeding them the same random number generator.
This assumption is true as far as the custom component in use:</p>
<ul>
<li>do not use any other random generator but the one provided by the simulation framework</li>
<li>do not iterate over collections with no predicible iteration order (i.e., <code>Set</code> and <code>Map</code>) containing elements (or
keys) whose <code>hashCode()</code> has not been overridden to return the same value regardless of the specific JVM in use.</li>
<li>do not run operations in parallel</li>
</ul>
<p>The <code>seeds</code> section may contain two optional values: <code>scenario</code> and <code>simulation</code>.
The former is the seed of the pseudo-random generator used during the creation of the simulation, e.g. for displacing
nodes in random arrangements.
The latter is the seed of the pseudo-random generator used during the simulation, e.g. for computing time distributions
or generating random positions.
A typical example in which one may want to have different values, is to keep the same random displacement of devices in
some scenario but allow events to happen with different timings.</p>
<p>A typical <code>seed</code> section may look like:</p>
<pre><code class="language-yaml">seeds:
  scenario: 0
  simulation: 1
</code></pre>
<p>Usually, in batches, you wan to run multiple runs per experiment, varying the simulation seed, in order to get more
reliable data (and appropriate error bars).
As per any other value, variables can be feeded as random generator seeds.
In the following example, 100 simulations are generated with different seeds (both for environment configuration and
simulation execution)</p>
<pre><code class="language-yaml">variables:
  random: &amp;random
    min: 0
    max: 9
    step: 1
    default: 0
seeds:
  # reference to the `random` variable
  scenario: *random
  simulation: *random
</code></pre>
<h2 id="defining-the-network">Defining the network</h2>
<p>The <code>network-model</code> key is used to load the implementation of LinkingRule to be used in the simulation,
which determines the neighborhood of every node.
The key is optional, but defaults to NoLinks, so if unspecified nodes in the environment don't get
connected.
Omitting such key is equivalent to writing any of the following:</p>
<pre><code class="language-yaml">network-model:
  type: NoLinks
</code></pre>
<pre><code class="language-yaml">network-model:
  type: it.unibo.alchemist.model.implementations.linkingrules.NoLinks
  parameters: []
</code></pre>
<pre><code class="language-yaml">network-model:
  type: NoLinks
  parameters: []
</code></pre>
<p>If no fully qualified linking rule name is provided for class loading, Alchemist uses the package
it.unibo.alchemist.model.implementations.linkingrules to search for the class.</p>
<h3 id="linking-nodes-based-on-distance">Linking nodes based on distance</h3>
<p>One of the most common ways of linking nodes is to connect those which are close enough to each other. To do so, you can
use the class ConnectWithinDistance, passing a parameter representing the maximum connection distance.
Note that such distance depends on the environment: while the definition of distance is straightforward for euclidean
spaces, it's not so for <a href="https://en.wikipedia.org/wiki/Riemannian_geometry">Riemannian manifolds</a>, which is a fancy
name to define geometries such as the one typical of a urban map (you can roughly interpret it as a euclidean space
&quot;with holes&quot;).
For instance, in case of environments using GeoPosition, the distance is computed in meters, so the
distance between <code>[44.133254, 12.237770]</code> and <code>[44.146680, 12.258627]</code> is about <code>2240</code> (meters).</p>
<pre><code class="language-yaml">network-model:
  type: ConnectWithinDistance
  # Link together all the nodes closer than 100 according to the distance function
  parameters: [100]
</code></pre>
<h2 id="displacing-nodes">Displacing nodes</h2>
<p>The <code>displacements</code> section lists the node locations at the beginning of the simulation.
Each displacement type extends the interface Displacement. If no fully qualified displacement name is
provided for class loading,
Alchemist uses the package it.unibo.alchemist.loader.displacements to search for the class.
The YAML key associated to displacements is <code>in</code>.</p>
<h3 id="displacing-on-specific-positions">Displacing on specific positions</h3>
<p>The following example places a single node in the (0, 0) Point.</p>
<pre><code class="language-yaml">displacements:
  # &quot;in&quot; entries, where each entry defines a group of nodes
  - in:
      type: Point
      # Using a constructor taking (x,y) coordinates
      parameters: [0, 0]
</code></pre>
<h3 id="displacing-multiple-nodes-at-once">Displacing multiple nodes at once</h3>
<p>This example places 10000 nodes randomly in a Circle with center in (0, 0) and radius 10.</p>
<pre><code class="language-yaml">displacements:
  - in:
      type: Circle
      parameters: [10000, 0, 0, 10]
</code></pre>
<p>Here instead nodes are located in a Grid centered in (0, 0), with nodes distanced of 0.25 both
horizontally and vertically, and whose position is not exact but randomly perturbed (±0.1 distance units).</p>
<pre><code class="language-yaml">displacements:
  - in:
      type: Grid
      parameters: [-5, -5, 5, 5, 0.25, 0.25, 0.1, 0.1]
</code></pre>
<h3 id="customizing-the-node-type">Customizing the node type</h3>
<p>In order to specify a particular node implementation you want to put inside the environment you can use the <code>nodes</code> key
followed by the name of the class and the parameters required to build it.</p>
<p>100 <code>MyCustomNodeImpl</code> nodes, whose constructor needs only the environment, placed in a circle with center in (0, 0) and
radius 20.</p>
<pre><code class="language-yaml">displacements:
  - in:
      type: Circle
      parameters: [100, 0, 0, 20]
    nodes:
      type: MyCustomNodeImpl
      parameters: []
</code></pre>
<p>The empty parameters section can be omitted (as per custom class loading mechanism):</p>
<pre><code class="language-yaml">displacements:
  - in:
      type: Circle
      parameters: [100, 0, 0, 20]
    nodes:
      type: MyCustomNodeImpl
</code></pre>
<h3 id="customizing-the-nodes-content">Customizing the nodes content</h3>
<p>It is possible to set the content of the nodes inside a given region. Only the nodes inside the Rectangle area contain
the <code>source</code> and <code>randomSensor</code> molecules (global variables).</p>
<pre><code class="language-yaml">displacements:
  - in:
      type: Grid
      parameters: [-5, -5, 5, 5, 0.25, 0.25, 0.1, 0.1]
    contents:
      - in:
          type: Rectangle
          parameters: [-6, -6, 2, 2]
        molecule: source
        concentration: true
      - molecule: randomSensor
        concentration: &gt;
          import java.lang.Math.random
          random() * pi
</code></pre>
<h2 id="writing-behaviors-reactions">Writing behaviors (Reactions)</h2>
<p>TODO!</p>
<p>Nodes can be programmed using reactions.</p>
<pre><code class="language-yaml"># Variable representing the program to be executed
gradient: &amp;gradient
  - time-distribution: 1
    # Make sure that the program folder is part of the project classpath
    program: program:package:distanceTo
  - program: send
displacements:
  - in:
      type: Grid
      parameters: [-5, -5, 5, 5, 0.25, 0.25, 0.1, 0.1]
    programs:
      # Reference to the &quot;gradient&quot; list of programs. This program is executed in all
      # the grid nodes
      - *gradient
</code></pre>
<h2 id="writing-layers">Writing layers</h2>
<p>It is possible to define overlays (layers) of data that can be sensed everywhere in the environment.
Layers can be used to model physical properties, such as pollution, light, temperature, and so on.
Conversely than readings from nodes' contents, layers have no dependency optimization.
This implies that reactions that read values from layers should have special care in defining their <code>context</code> appropriately</p>
<p>In order to create layer, the programmer must define the type of the layer, a molecule that will be used as identifier,
and possibly the parameters needed for intializing the type of layer you have chosen, as per the <a href="#loading-arbitrary-java-classes-with-the-typeparameters-syntax"><code>type/parameter</code> syntax</a>.</p>
<p>The following example exemplifies the syntax for initializing two BidimensionalGaussianLayer:</p>
<pre><code class="language-yaml">layers:
  - type: BidimensionalGaussianLayer
    molecule: foo
    parameters: [0.0, 0.0, 2.0, 5.0]
  - type: BidimensionalGaussianLayer
    molecule: bar
    parameters: [0.0, 0.0, 5.0, 10.0]
</code></pre>

                    
                
            
        
            
        
    
    <!-- end:inject components -->


        
        </div>

        <!-- Page navigation
        =========================================== -->
        <div class="col-md-3" role="complementary">
        <div class="bs-docs-sidebar hidden-print" id="bs-docs-sidebar">
    

    <ul class="nav bs-docs-sidenav">
        
    </ul>

    
    <!-- start:inject components -->
    
    <!-- end:inject components -->



    <a class="back-to-top" href="#top">
        <i class="glyphicon glyphicon-chevron-up"></i> Back to top
    </a>
</div>

        </div>
    </div>
</div>


<div id="footer">
    <div class="container bs-docs-container">
    <footer class="bs-docs-footer" role="contentinfo">
    <div class="row">
        <div class="col-xs-12">
            <nav aria-label="navigateClasses">
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="http://localhost:8080/wiki/usage/quickstart">
                                <span aria-hidden="true">&larr;</span>
                                <span>Quick start</span>
                            </a>
                        </li>
                    

                    
                        <li class="next">
                            <a href="http://localhost:8080/wiki/usage/gui">
                                <span>Alchemist graphical interface</span>
                                <span aria-hidden="true">&rarr;</span>
                            </a>
                        </li>
                    
                </ul>
            </nav>
        </div>
    </div>
    <div class="icons">
    
    
        <a href="https://github.com/Protelis/Protelis" class="fa fa-github"></a>
    
    
    </div>
    <br>
    <p>
    Documentation template based on the
    <a href="https://github.com/mistic100/jekyll-bootstrap-doc">Jekyll Bootstrap Doc</a>
    Jekyll theme by the <a href="https://getbootstrap.com">Bootstrap team</a>. Site created with
    <a href="https://orchid.netlify.com">Orchid</a>.
</p>

<ul class="bs-docs-footer-links muted">
    <li>Currently 13.0.3-dev18+2bb83c70</li>
</ul>

</footer>
    </div>
</div>


<!-- start:inject scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.3.0/bootbox.min.js"></script>
<script src="http://localhost:8080/BsDoc/447b9123/assets/js/bsdoc.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-kotlin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-groovy.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-asciidoc.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-markdown.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-python.min.js"></script>
<!-- end:inject scripts -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/trianglify/1.2.0/trianglify.min.js"></script>

<script>
    $(function () {
        window.colors = ['#2299d8', '#000000'];
                  
    trianglify({});

        buildNav();
    });
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>




<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
<meta name="generator" content="Orchid 0.17.5"/>
<link rel="icon" href="http://localhost:8080/favicon.ico">


<meta name="robots" content="index, follow">



<title>Maps and GPS traces</title>


<meta name="description" content="Practical aggregate programming.">



<link rel="prev" href="http://localhost:8080/wiki/usage/smartcam">


<link rel="next" href="http://localhost:8080/wiki/usage/export">


<script>
    window.site = {"orchidVersion":"0.17.5","baseUrl":"http://localhost:8080","environment":"debug","version":"13.0.3-dev18+2bb83c70"};
</script>





<!-- start:debug info -->

<!-- THEME -->
<!-- Type: BsDoc -->
<!-- Class: com.eden.orchid.bsdoc.BSDocTheme -->

<!-- PAGE -->
<!-- Type: wiki -->
<!-- Class: com.eden.orchid.wiki.pages.WikiPage -->
<!-- Layout: index -->
<!-- Resolved Layout: templates/layouts/index.peb -->
<!-- Page Template: wiki, page -->
<!-- Resolved Page Template:  -->

<!-- RESOURCE -->
<!-- Class: com.eden.orchid.api.resources.resource.FileResource -->
<!-- Source Filename: wiki/usage/maps.md -->

<!-- COMPLETE PAGE CONFIGURATION -->
<script>
    window.allData = {"reference":{"path":"wiki/usage","baseUrl":"http://localhost:8080","fileName":"maps","extension":"html","usePrettyUrl":true,"link":"http://localhost:8080/wiki/usage/maps"},"next":{"path":"wiki/usage","baseUrl":"http://localhost:8080","fileName":"export","extension":"html","usePrettyUrl":true,"link":"http://localhost:8080/wiki/usage/export"},"previous":{"path":"wiki/usage","baseUrl":"http://localhost:8080","fileName":"smartcam","extension":"html","usePrettyUrl":true,"link":"http://localhost:8080/wiki/usage/smartcam"},"description":"","title":"Maps and GPS traces"};
</script>

<!-- end:debug info -->



<!-- start:inject styles -->
<link rel="stylesheet" type="text/css" href="https://netdna.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css"/>
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.0/gh-fork-ribbon.min.css"/>
<link rel="stylesheet" type="text/css" href="http://localhost:8080/BsDoc/447b9123/assets/css/bsdoc.css"/>
<link rel="stylesheet" type="text/css" href="http://localhost:8080/assets/css/pygments.css"/>
<link rel="stylesheet" type="text/css" href="https://rawgit.com/PrismJS/prism-themes/master/themes/prism-ghcolors.css"/>
<!-- end:inject styles -->


</head>
<body>




<a class="github-fork-ribbon left-top"
   href="https://github.com/Protelis/Protelis"
   title="Fork me on GitHub">Fork me on GitHub</a>


<header class="navbar navbar-fixed-top bs-docs-nav">
    <div class="container">
        <div class="navbar-header" role="banner">
            <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://localhost:8080">Protelis: the language for aggregate computing</a>
        </div>
        <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
            <ul class="nav navbar-nav navbar-right">
                
                    
                        <li><a href="http://localhost:8080">Home</a></li>
                    
                
                    
                        <li><a href="">Documentation</a></li>
                    
                
                    
                        <li><a href="http://localhost:8080/wiki/quickstart">Quick start</a></li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Tutorials<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="http://localhost:8080/wiki/tutorials/alchemist">Simulations with Alchemist</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li><a href="http://localhost:8080/wiki/language">Undestand</a></li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">understand<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="http://localhost:8080/wiki/understand/basics">Aggregate programming basics</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/understand/architecture">Protelis&#39; architecture</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/understand/syntax">Upgrade guide</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Use<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="http://localhost:8080/wiki/usage/installation">Requirements and installation</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/quickstart">Quick start</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/gui">Alchemist graphical interface</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/biochemistry">Alchemist biochemistry incarnation</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/protelis">Alchemist Protelis incarnation</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/sapere">SAPERE</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/scafi">Scafi</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/indoor">Simulation of indoor environments</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/cognitive-agents">Using Cognitive Agents</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/smartcam">With Smart Cameras</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/maps">Maps and GPS traces</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/export">Exporting data</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/batch">Executing batches</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/grid">Grid computing support</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/customization">Writing custom components</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/usage/issues">Troubleshooting and known issues</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li class="dropdown">
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">Simulation examples<span class="caret"></span></a>
                            <ul class="dropdown-menu scrollable-menu">
                                
                                    <li><a href="http://localhost:8080/wiki/examples/protelis">With Protelis</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/examples/scafi">With Scafi</a></li>
                                
                                    <li><a href="http://localhost:8080/wiki/examples/maps">On maps</a></li>
                                
                            </ul>
                        </li>
                    
                
                    
                        <li><a href="http://localhost:8080/wiki/license">License</a></li>
                    
                
            </ul>
        </nav>
    </div>
</header>


<div id="top"></div>


    <div class="bs-docs-masthead" id="jumbotron">
        <div class="container">
            <h1 class="home-title">Maps and GPS traces</h1>
        </div>
    </div>


<div class="container bs-docs-container">
    <div class="row">
        <div class="col-md-9" role="main">
        <nav aria-label="breadcrumb">
    <ul class="breadcrumb">
    
    
        <li class="breadcrumb-item"><a href="http://localhost:8080/wiki">Wiki</a></li>
    
    
    
        <li class="breadcrumb-item active" aria-current="page">Maps and GPS traces</li>
    
    
    </ul>
</nav>
        

        
        
            
    <!-- start:inject components -->
    
        
            
                
                    
                        <p>Alchemist is equipped with the ability to load and simulate on real-world maps.
Navigation on maps can be done by using gps traces,
by moving along roads (Alchemist relies on <a href="https://www.graphhopper.com/">GraphHopper</a> to provide directions),
by interpolating gps traces with on-the-road-movements,
or by ignoring the map information on just move as you would in a continuous space.</p>
<h2 id="setting-up-a-map-environment">Setting up a map environment</h2>
<p>In order to run simulations on real world maps, an appropriate environment must be selected.</p>
<p>Currently, the only environment supporting maps is OSMEnvironment.</p>
<p>The only mandatory parameter is the <code>path</code> of the file with the map to be loaded. Accepts OSM maps of any format (xml, osm, pbf).
Is possible define other optional parameter like:</p>
<ol start="0">
<li><code>approximation: Int</code> -&gt; the amount of ciphers of the IEEE 754 encoded position that may be discarded when comparing two positions, allowing a quicker retrieval of the route between two position, since the cache may already contain a similar route which can be considered to be the same route, according to the level of precision determined by this value</li>
<li><code>onStreets: Boolean</code> -&gt; if true, the nodes will be placed on the street nearest to the desired position</li>
<li><code>onlyOnStreets: Boolean</code> -&gt; if true, the nodes which are too far from a street will be simply discarded. If false, they will be placed anyway, in the original position</li>
</ol>
<p>The following example shows how to configure a simulation that loads data from an Openstreetmap file
(OSM, XML and PBF formats are supported) located in the classpath folder <code>maps</code>:</p>
<pre><code class="language-yaml">incarnation: protelis
environment:
  type: OSMEnvironment
  parameters: [maps/foo.pbf]
</code></pre>
<h2 id="using-gps-traces-to-displace-nodes">Using GPS traces to displace nodes</h2>
<p>GPS traces can be used to displace nodes on a map.
In order to set the initial position of the nodes with the first position of the GPS traces,
you need to use the displacement FromGPSTrace.
The displacement <code>FromGPSTrace</code> require the following parameters:</p>
<ol start="0">
<li>number of nodes to displace</li>
<li>file with the GPS traces to use</li>
<li>boolean that indicates if the list of GPS trace is cyclic.
If <code>true</code> and the GPS traces are less than the number of nodes to be displaced,
then the traces are cyclically re-used to displace nodes.</li>
<li>a GPSTimeAlignment to define how to align the time of all the GPS points of all GPS traces.
There are present several strategy in the package it.unibo.alchemist.boundary.gpsload.api
and introduced in the following subsection.</li>
</ol>
<p>The following example places 1497 nodes with the first position of the GPS traces in the file <code>vcmuser.gpx</code>.
The list of GPS traces isn't cyclic.
The strategy to align time of all the GPS points is AlignTime
in order to consider only the GPS points with attribute <code>time</code> greater than the specified one
(in milliseconds from epoch).</p>
<pre><code class="language-yaml">displacements:
  - in:
      type: FromGPSTrace
      parameters: [1497, &quot;vcmuser.gpx&quot;, false, &quot;AlignToTime&quot;, 1365922800, false, false]
</code></pre>
<h3 id="strategy-to-align-time-of-gps-trace">Strategy to align time of GPS trace</h3>
<p>The strategies available to align time of GPS trace are the following:</p>
<ol start="0">
<li>NoAlignment -&gt; No alignment is performed.</li>
<li>AlignToFirstTrace -&gt; Aligns all traces at the start time of the first trace.
If you have two traces, the first trace start with time = 2 and second point with time = 5,
the second trace start with time = 4 and second point with time = 6,
the result will be:
<ul>
<li>first trace -&gt; start with time = 0 and second point with time = 3</li>
<li>second trace -&gt; start with time = 2 and second point with time = 4</li>
</ul>
</li>
<li>AlignToSimulationTime -&gt; Aligns all traces at the initial simulation time.
If you have two traces, the first trace start with time = 2 and second point with time = 5,
the second trace start with time = 4 and second point with time = 6,
the result will be:
<ul>
<li>first trace -&gt; start with time = 0 and second point with time = 3</li>
<li>second trace -&gt; start with time = 0 and second point with time = 2</li>
</ul>
</li>
<li>AlignToTime -&gt; Aligns the traces with the given time in seconds from Epoch.
All points before such time will be discarded. All points after the provided time will
be shifted back.
If you have two traces, the first trace start with time = 2 and second point with time = 5,
the second trace start with time = 4 and second point with time = 6, the given time is 3
the result will be:
<ul>
<li>first trace -&gt; first point discarded and second point with time = 2</li>
<li>second trace -&gt; start with time = 1 and second point with time = 3</li>
</ul>
</li>
</ol>
<h2 id="navigation">Navigation</h2>
<p>As previous say there are several behavior in order to move the nodes in a environment with real-word map:</p>
<ol start="0">
<li>movement ignoring map information. A node move directly from start position to destination position:
<img src="http://localhost:8080/assets/media/usage/no_map_information.png" alt="No map information" /></li>
<li>movement by using map information. A node move from start position to destination position using
intermediate position in order to follow streets and avoid obstacle (like building):
<img src="http://localhost:8080/assets/media/usage/use_map_information.png" alt="Use map information" /></li>
<li>movement by reproducing a GPS trace (action ReproduceGPSTrace).
A node start to the first position of the GPS trace, than move to the next
position of the trace until arrive to the last. The movement from a position to another is direct with a straight line:
<img src="http://localhost:8080/assets/media/usage/reproduce_gps_trace.png" alt="Reproduce GPS trace" /></li>
<li>movement by interpolating the GPS trace with street data (action GPSTraceWalker).
A node start to the first position of the GPS trace,
than move to the next position of the trace until arrive to the last. The movement from a position to another
use map information to define intermediate position in order to follow streets and avoid obstacle (like building):
<img src="" alt="Interpolate GPS trace with street data" /></li>
</ol>
<p>Both the actions ReproduceGPSTrace and GPSTraceWalker require:
0. the file with the GPS traces
0. a boolean that indicate if the list of GPS trace is cyclic
0. the strategy to align the attribute <code>time</code> of the GPS points of the GPS traces</p>
<p>The following example show how it is possible define a program to follow GPS traces.</p>
<pre><code class="language-yaml">programs:
  - time-distribution: 0.1
  type: Event
  actions:
    - type: ReproduceGPSTrace
      parameters: [&quot;/vcmuser.gpx&quot;, false, &quot;AlignToTime&quot;, 1365922800, false, false]
</code></pre>

                    
                
            
        
            
        
    
    <!-- end:inject components -->


        
        </div>

        <!-- Page navigation
        =========================================== -->
        <div class="col-md-3" role="complementary">
        <div class="bs-docs-sidebar hidden-print" id="bs-docs-sidebar">
    

    <ul class="nav bs-docs-sidenav">
        
    </ul>

    
    <!-- start:inject components -->
    
    <!-- end:inject components -->



    <a class="back-to-top" href="#top">
        <i class="glyphicon glyphicon-chevron-up"></i> Back to top
    </a>
</div>

        </div>
    </div>
</div>


<div id="footer">
    <div class="container bs-docs-container">
    <footer class="bs-docs-footer" role="contentinfo">
    <div class="row">
        <div class="col-xs-12">
            <nav aria-label="navigateClasses">
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="http://localhost:8080/wiki/usage/smartcam">
                                <span aria-hidden="true">&larr;</span>
                                <span>With Smart Cameras</span>
                            </a>
                        </li>
                    

                    
                        <li class="next">
                            <a href="http://localhost:8080/wiki/usage/export">
                                <span>Exporting data</span>
                                <span aria-hidden="true">&rarr;</span>
                            </a>
                        </li>
                    
                </ul>
            </nav>
        </div>
    </div>
    <div class="icons">
    
    
        <a href="https://github.com/Protelis/Protelis" class="fa fa-github"></a>
    
    
    </div>
    <br>
    <p>
    Documentation template based on the
    <a href="https://github.com/mistic100/jekyll-bootstrap-doc">Jekyll Bootstrap Doc</a>
    Jekyll theme by the <a href="https://getbootstrap.com">Bootstrap team</a>. Site created with
    <a href="https://orchid.netlify.com">Orchid</a>.
</p>

<ul class="bs-docs-footer-links muted">
    <li>Currently 13.0.3-dev18+2bb83c70</li>
</ul>

</footer>
    </div>
</div>


<!-- start:inject scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.3.0/bootbox.min.js"></script>
<script src="http://localhost:8080/BsDoc/447b9123/assets/js/bsdoc.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-kotlin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-java.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-groovy.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-asciidoc.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-markdown.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/components/prism-python.min.js"></script>
<!-- end:inject scripts -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/trianglify/1.2.0/trianglify.min.js"></script>

<script>
    $(function () {
        window.colors = ['#2299d8', '#000000'];
                  
    trianglify({});

        buildNav();
    });
</script>

</body>
</html>